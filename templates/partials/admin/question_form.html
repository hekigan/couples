{{if .QuestionID}}
{{/* Edit Mode - Language selector to choose which translation to edit */}}
<form id="question-form"
      hx-put="/admin/api/v1/questions/{{.QuestionID}}"
      hx-swap="none"
      hx-on::after-request="handleDataUpdateResponse(event, '/admin/api/questions/list', '#questions-list')">
	<input type="hidden" name="base_question_id" value="{{.BaseQuestionID}}">

	<div class="grid">
		<fieldset role="group">
			<label>Category</label>
			<select name="category_id" required>
				{{range .Categories}}
				<option value="{{.ID}}" {{if .Selected}}selected{{end}}>{{.Label}}</option>
				{{end}}
			</select>
		</fieldset>

		<fieldset role="group">
			<label>Language:</label>
			<select name="lang_code" id="lang_code" required onchange="handleLanguageChange(event)">
				<option value="en" {{if .LangEN}}selected{{end}}>English</option>
				<option value="fr" {{if .LangFR}}selected{{end}}>French</option>
				<option value="ja" {{if .LangJA}}selected{{end}}>Japanese</option>
			</select>
		</fieldset>
	</div>

	<label>English Question Text:</label>
	<textarea id="question_text" name="question_text" required rows="2" {{if ne .SelectedLang "en"}}disabled{{end}}>{{.QuestionText}}</textarea>

	<div id="translation-section" {{if eq .SelectedLang "en"}}style="display:none"{{end}}>
		<label id="translation-label">
			{{if eq .SelectedLang "fr"}}French Translation:{{else if eq .SelectedLang "ja"}}Japanese Translation:{{else}}Translation:{{end}}
		</label>
		<textarea id="question_text_translation" name="question_text_translation" rows="2" {{if ne .SelectedLang "en"}}required{{end}}>{{if eq .SelectedLang "fr"}}{{.TranslationFR}}{{else if eq .SelectedLang "ja"}}{{.TranslationJA}}{{end}}</textarea>
	</div>

	<script>
	function handleLanguageChange(event) {
		const langCode = event.target.value;
		const questionTextArea = document.getElementById('question_text');
		const translationSection = document.getElementById('translation-section');
		const translationLabel = document.getElementById('translation-label');
		const translationTextArea = document.getElementById('question_text_translation');

		if (langCode === 'en') {
			questionTextArea.disabled = false;
			translationSection.style.display = 'none';
			translationTextArea.required = false;
		} else {
			questionTextArea.disabled = true;
			translationSection.style.display = 'block';
			translationTextArea.required = true;

			if (langCode === 'fr') {
				translationLabel.textContent = 'French Translation:';
				translationTextArea.value = '{{.TranslationFR}}';
			} else if (langCode === 'ja') {
				translationLabel.textContent = 'Japanese Translation:';
				translationTextArea.value = '{{.TranslationJA}}';
			}
		}
	}
	</script>
</form>

{{else}}
{{/* Create Mode - Show all three language fields at once */}}
<form id="question-form"
      hx-post="/admin/api/v1/questions"
      hx-swap="none"
      hx-on::after-request="handleDataUpdateResponse(event, '/admin/api/questions/list', '#questions-list')">

	<fieldset role="group">
		<label>Category</label>
		<select name="category_id" required>
			{{range .Categories}}
			<option value="{{.ID}}">{{.Label}}</option>
			{{end}}
		</select>
	</fieldset>

	<label>English Question Text: <span style="color: red;">*</span></label>
	<textarea name="question_text_en" required rows="2" placeholder="Enter English question...">{{.QuestionText}}</textarea>

	<label>French Translation: <span style="color: gray;">(optional)</span></label>
	<textarea name="question_text_fr" rows="2" placeholder="Enter French translation...">{{.TranslationFR}}</textarea>

	<label>Japanese Translation: <span style="color: gray;">(optional)</span></label>
	<textarea name="question_text_ja" rows="2" placeholder="Enter Japanese translation...">{{.TranslationJA}}</textarea>
</form>
{{end}}
