{{define "pagination"}}
{{/*
Generic pagination controls for admin tables
Required data fields:
  - TotalCount: int - Total number of items
  - CurrentPage: int - Current page number
  - TotalPages: int - Total number of pages
  - ItemsPerPage: int - Items per page
  - BaseURL: string - API URL for fetching data (e.g., "/admin/api/questions/list")
  - PageURL: string - Page URL for browser history (e.g., "/admin/questions")
  - Target: string - HTMX target selector (e.g., "#questions-list")
  - IncludeSelector: string - Selector for additional params (e.g., "[name='category_id']")
  - ExtraParams: string - Additional query parameters (e.g., "&category_id=xyz")
  - ItemName: string - Name of items for display (e.g., "questions", "users")
*/}}
<div class="pagination">
	<span class="pagination-info">
		Showing {{if gt .TotalCount 0}}{{add (mul (sub .CurrentPage 1) .ItemsPerPage) 1}}-{{if gt (mul .CurrentPage .ItemsPerPage) .TotalCount}}{{.TotalCount}}{{else}}{{mul .CurrentPage .ItemsPerPage}}{{end}}{{else}}0{{end}} of {{.TotalCount}} {{.ItemName}}
	</span>

	<div class="pagination-controls">
		<label for="per-page-select">Items per page:</label>
		<select id="per-page-select"
		        name="per_page"
		        hx-get="{{.BaseURL}}"
		        hx-target="{{.Target}}"
		        hx-swap="outerHTML"
		        hx-push-url="{{.PageURL}}"
		        hx-include="{{.IncludeSelector}}"
		        onchange="savePerPagePref(this.value)">
			<option value="25" {{if eq .ItemsPerPage 25}}selected{{end}}>25</option>
			<option value="50" {{if eq .ItemsPerPage 50}}selected{{end}}>50</option>
			<option value="100" {{if eq .ItemsPerPage 100}}selected{{end}}>100</option>
		</select>

		<div class="pagination-buttons">
			{{if gt .CurrentPage 1}}
			<button hx-get="{{.BaseURL}}?page={{sub .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{.ExtraParams}}"
			        hx-target="{{.Target}}"
			        hx-swap="outerHTML"
			        hx-push-url="{{.PageURL}}?page={{sub .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{.ExtraParams}}"
			        class="btn btn-sm">◄ Prev</button>
			{{end}}

			{{range $i := until .TotalPages}}
			{{$pageNum := add $i 1}}
			{{if or (eq $pageNum 1) (eq $pageNum $.TotalPages) (and (gte $pageNum (sub $.CurrentPage 2)) (lte $pageNum (add $.CurrentPage 2)))}}
			<button hx-get="{{$.BaseURL}}?page={{$pageNum}}&per_page={{$.ItemsPerPage}}{{$.ExtraParams}}"
			        hx-target="{{$.Target}}"
			        hx-swap="outerHTML"
			        hx-push-url="{{$.PageURL}}?page={{$pageNum}}&per_page={{$.ItemsPerPage}}{{$.ExtraParams}}"
			        class="btn btn-sm {{if eq $pageNum $.CurrentPage}}active{{end}}">{{$pageNum}}</button>
			{{else if or (eq $pageNum 2) (eq $pageNum (sub $.TotalPages 1))}}
			<span class="pagination-ellipsis">...</span>
			{{end}}
			{{end}}

			{{if lt .CurrentPage .TotalPages}}
			<button hx-get="{{.BaseURL}}?page={{add .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{.ExtraParams}}"
			        hx-target="{{.Target}}"
			        hx-swap="outerHTML"
			        hx-push-url="{{.PageURL}}?page={{add .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{.ExtraParams}}"
			        class="btn btn-sm">Next ►</button>
			{{end}}
		</div>
	</div>
</div>
{{end}}
