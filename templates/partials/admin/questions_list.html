<div id="questions-list">
	<div class="filters">
		<select hx-get="/admin/api/questions/list"
		        hx-target="#questions-list"
		        hx-swap="outerHTML"
		        hx-push-url="/admin/questions"
		        hx-include="[name='per_page']"
		        name="category_id">
			<option value="">All Categories ({{.TotalCount}})</option>
			{{range .Categories}}
			<option value="{{.ID}}" {{if .Selected}}selected{{end}}>{{.Icon}} {{.Label}} ({{.QuestionCount}})</option>
			{{end}}
		</select>

		{{if gt .MissingTranslationsCount 0}}
		<span class="missing-translations-badge">⚠️ {{.MissingTranslationsCount}} incomplete translations</span>
		{{end}}
	</div>

	<table>
		<thead>
			<tr>
				<th>Question Text</th>
				<th>Category</th>
				<th>Translations</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody>
			{{range .Questions}}
			<tr>
				<td>{{.Text}}</td>
				<td>{{.CategoryLabel}}</td>
				<td>
					{{if eq .TranslationCount 3}}
					<span class="translation-badge complete">{{.TranslationCount}}/3</span>
					{{else}}
					<span class="translation-badge incomplete">{{.TranslationCount}}/3</span>
					{{end}}
				</td>
				<td>
					<button hx-get="/admin/api/questions/{{.ID}}/edit-form"
					        hx-target="#edit-modal-content"
					        hx-swap="innerHTML"
					        onclick="document.getElementById('edit-modal').style.display='block'"
					        class="btn btn-sm">
						Edit
					</button>
					<button hx-delete="/admin/api/questions/{{.ID}}"
					        hx-target="#questions-list"
					        hx-swap="outerHTML"
					        hx-push-url="true"
					        hx-confirm="Are you sure you want to delete this question?"
					        class="btn btn-sm btn-danger">
						Delete
					</button>
				</td>
			</tr>
			{{end}}
		</tbody>
	</table>

	{{/* Reusable pagination controls - see templates/partials/admin/pagination.html for standalone version */}}
	<div class="pagination">
		<span class="pagination-info">
			Showing {{if gt .TotalCount 0}}{{add (mul (sub .CurrentPage 1) .ItemsPerPage) 1}}-{{if gt (mul .CurrentPage .ItemsPerPage) .TotalCount}}{{.TotalCount}}{{else}}{{mul .CurrentPage .ItemsPerPage}}{{end}}{{else}}0{{end}} of {{.TotalCount}} questions
		</span>

		<div class="pagination-controls">
			<label for="per-page-select">Items per page:</label>
			<select id="per-page-select"
			        name="per_page"
			        hx-get="/admin/api/questions/list"
			        hx-target="#questions-list"
			        hx-swap="outerHTML"
			        hx-push-url="/admin/questions"
			        hx-include="[name='category_id']"
			        onchange="savePerPagePref(this.value)">
				<option value="25" {{if eq .ItemsPerPage 25}}selected{{end}}>25</option>
				<option value="50" {{if eq .ItemsPerPage 50}}selected{{end}}>50</option>
				<option value="100" {{if eq .ItemsPerPage 100}}selected{{end}}>100</option>
			</select>

			<div class="pagination-buttons">
				{{if gt .CurrentPage 1}}
				<button hx-get="/admin/api/questions/list?page={{sub .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{if .SelectedCategoryID}}&category_id={{.SelectedCategoryID}}{{end}}"
				        hx-target="#questions-list"
				        hx-swap="outerHTML"
				        hx-push-url="/admin/questions?page={{sub .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{if .SelectedCategoryID}}&category_id={{.SelectedCategoryID}}{{end}}"
				        class="btn btn-sm">◄ Prev</button>
				{{end}}

				{{range $i := until .TotalPages}}
				{{$pageNum := add $i 1}}
				{{if or (eq $pageNum 1) (eq $pageNum $.TotalPages) (and (gte $pageNum (sub $.CurrentPage 2)) (lte $pageNum (add $.CurrentPage 2)))}}
				<button hx-get="/admin/api/questions/list?page={{$pageNum}}&per_page={{$.ItemsPerPage}}{{if $.SelectedCategoryID}}&category_id={{$.SelectedCategoryID}}{{end}}"
				        hx-target="#questions-list"
				        hx-swap="outerHTML"
				        hx-push-url="/admin/questions?page={{$pageNum}}&per_page={{$.ItemsPerPage}}{{if $.SelectedCategoryID}}&category_id={{$.SelectedCategoryID}}{{end}}"
				        class="btn btn-sm {{if eq $pageNum $.CurrentPage}}active{{end}}">{{$pageNum}}</button>
				{{else if or (eq $pageNum 2) (eq $pageNum (sub $.TotalPages 1))}}
				<span class="pagination-ellipsis">...</span>
				{{end}}
				{{end}}

				{{if lt .CurrentPage .TotalPages}}
				<button hx-get="/admin/api/questions/list?page={{add .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{if .SelectedCategoryID}}&category_id={{.SelectedCategoryID}}{{end}}"
				        hx-target="#questions-list"
				        hx-swap="outerHTML"
				        hx-push-url="/admin/questions?page={{add .CurrentPage 1}}&per_page={{.ItemsPerPage}}{{if $.SelectedCategoryID}}&category_id={{$.SelectedCategoryID}}{{end}}"
				        class="btn btn-sm">Next ►</button>
				{{end}}
			</div>
		</div>
	</div>
</div>
