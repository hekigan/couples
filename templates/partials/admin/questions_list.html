{{define "questions_list"}}
<div id="questions-list">
	<!-- Loading Overlay -->
	<div id="questions-list-loading" class="htmx-indicator admin-list-loading-overlay">
		<div class="loading-overlay-content">
			<div class="spinner"></div>
			<p>Loading questions...</p>
		</div>
	</div>

	<div class="filters">
		<select hx-get="/admin/api/v1/questions/list"
		        hx-target="#questions-list"
		        hx-swap="outerHTML"
		        hx-push-url="/admin/questions"
		        hx-include="[name='per_page']"
		        hx-indicator="#questions-list-loading"
		        name="category_id">
			<option value="">All Categories ({{.TotalCount}})</option>
			{{range .Categories}}
			<option value="{{.ID}}" {{if .Selected}}selected{{end}}>{{.Label}} ({{.QuestionCount}})</option>
			{{end}}
		</select>

		{{if gt .MissingTranslationsCount 0}}
		<span class="missing-translations-badge">⚠️ {{.MissingTranslationsCount}} incomplete translations</span>
		{{end}}
	</div>

	<table class="striped">
		<thead>
			<tr>
				<th>Question Text</th>
				<th>Category</th>
				<th>Translations</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody>
			{{range .Questions}}
			<tr>
				<td>{{.Text}}</td>
				<td>{{.CategoryLabel}}</td>
				<td>
					{{if eq .TranslationCount 3}}
					<span class="translation-badge complete">{{.TranslationCount}}/3</span>
					{{else}}
					<span class="translation-badge incomplete">{{.TranslationCount}}/3</span>
					{{end}}
				</td>
				<td>
					<button hx-get="/admin/api/v1/questions/{{.ID}}/edit-form"
					        hx-target="#edit-modal-content"
					        hx-swap="innerHTML"
					        data-target="edit-modal"
					        onclick="toggleModal(event)"
					        class="warning">
						Edit
					</button>
					<button hx-delete="/admin/api/v1/questions/{{.ID}}"
					        hx-target="#questions-list"
					        hx-swap="outerHTML"
					        hx-push-url="true"
					        hx-confirm="Are you sure you want to delete this question?"
					        hx-indicator="#questions-list-loading"
					        class="danger">
						Delete
					</button>
				</td>
			</tr>
			{{end}}
		</tbody>
	</table>

	{{/* Use reusable pagination template */}}
	{{template "pagination" .}}
</div>
{{end}}
