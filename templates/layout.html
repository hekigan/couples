{{define "layout.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{if .Title}}{{.Title}}{{else}}Couple Card Game{{end}}</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/notifications.css">
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    
    <!-- Realtime Client -->
    <script src="/static/js/realtime.js" defer></script>
    
    <!-- Notifications Script (Real-time version) -->
    <script src="/static/js/notifications-realtime.js" defer></script>
    
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">
                    <span class="logo-icon">üíï</span>
                    <span class="logo-text">Couple Card Game</span>
                </a>
                
                <nav class="main-nav">
                    {{if .User}}
                        <a href="/friends" class="nav-link">Friends</a>
                        <a href="/game/rooms" class="nav-link">My Rooms</a>
                        <a href="/profile" class="nav-link">Profile</a>
                        
                        <!-- Notification Bell -->
                        <div class="notification-container">
                            <button class="notification-bell" onclick="toggleNotifications()" id="notification-btn">
                                üì¨
                                <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                            </button>
                            <div class="notification-dropdown" id="notification-dropdown" style="display: none;">
                                <div class="notification-header">
                                    <h3>Notifications</h3>
                                    <button onclick="markAllRead()" class="mark-read-btn">Mark all read</button>
                                </div>
                                <div class="notification-list" id="notification-list">
                                    <p class="loading">Loading...</p>
                                </div>
                            </div>
                        </div>
                        
                        <form action="/auth/logout" method="POST" style="display: inline;">
                            <button type="submit" class="btn btn-secondary btn-sm">Logout</button>
                        </form>
                    {{else}}
                        <a href="/auth/login" class="btn btn-primary btn-sm">Login</a>
                    {{end}}
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        {{if .Error}}
        <div class="alert alert-error">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span class="alert-message">{{.Error}}</span>
        </div>
        {{end}}

        {{if .Success}}
        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <span class="alert-message">{{.Success}}</span>
        </div>
        {{end}}

        {{template "content" .}}
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 Couple Card Game. Made with ‚ù§Ô∏è for couples everywhere.</p>
        </div>
    </footer>
</body>
</html>
{{end}}

