{{define "layout.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{if .Title}}{{.Title}}{{else}}Couple Card Game{{end}}</title>
    
    <!-- CSS - Pico CSS with custom pastel theme -->
    <link rel="stylesheet" href="/static/css/main.css">
    
    <!-- HTMX Core and SSE Extension -->
    <script src="/static/js/htmx.min.js"></script>
    <script src="/static/js/sse.js"></script>

    <!-- UI Utilities (Toast, Loading, etc.) -->
    <script src="/static/js/ui-utils.js"></script>

    <!-- Realtime Client (legacy JavaScript SSE - will be removed in future) -->
    <!-- <script src="/static/js/realtime.js" defer></script> -->

    <!-- Notifications Script (Real-time version) -->
    <script src="/static/js/notifications-realtime.js" defer></script>
    
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">
                    <span class="logo-icon">üíï</span>
                    <span class="logo-text">Couple Card Game</span>
                </a>
                
                <nav class="main-nav">
                    {{if .User}}
                    <!-- Notification Bell -->
                        <a href="#" class="notification-bell" onclick="toggleNotifications()" id="notification-btn">
                            üìß
                            <span class="notification-badge" id="notification-badge" hidden>0</span>
                        </a>
                        <div class="notification-dropdown" id="notification-dropdown" hidden>
                            <div class="notification-header">
                                <h3>Notifications</h3>
                                <button onclick="markAllRead()" class="mark-read-btn">Mark all read</button>
                            </div>
                            <div class="notification-list" id="notification-list">
                                <p class="loading">Loading...</p>
                            </div>
                        </div>

                        <a href="/friends" class="nav-link">Friends</a>
                        <a href="/game/rooms" class="nav-link">My Rooms</a>
                        <a href="/profile" class="nav-link">Profile</a>
                        
                        <a href="#" hx-post="/auth/logout" hx-confirm="Are you sure you want to logout?" class="nav-link">Logout</a>
                    {{else}}
                        <a href="/auth/login" role="button">Login</a>
                    {{end}}
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        {{if .Error}}
        <div class="alert alert-error">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span class="alert-message">{{.Error}}</span>
        </div>
        {{end}}

        {{if .Success}}
        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <span class="alert-message">{{.Success}}</span>
        </div>
        {{end}}

        {{template "content" .}}
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 Couple Card Game. Made with ‚ù§Ô∏è for couples everywhere.</p>
        </div>
    </footer>
</body>
</html>
{{end}}

