{{define "layout.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{if .Title}}{{.Title}}{{else}}Couple Card Game{{end}}</title>
    
    <!-- CSS - Pico CSS with custom pastel theme -->
    <link rel="stylesheet" href="/static/css/main.css">

    <!-- Admin CSS (only for admin pages) -->
    {{if .IsAdmin}}
    <link rel="stylesheet" href="/static/css/admin.css">
    {{end}}

    <!-- HTMX Core and SSE Extension -->
    <script src="/static/js/htmx.min.js"></script>
    <script src="/static/js/sse.js"></script>

    <!-- UI Utilities (Toast, Loading, etc.) -->
    <script src="/static/js/ui-utils.js"></script>

    <!-- Realtime Client (legacy JavaScript SSE - will be removed in future) -->
    <!-- <script src="/static/js/realtime.js" defer></script> -->

    <!-- Notifications Script (Real-time version) -->
    <script src="/static/js/notifications-realtime.js" defer></script>
    <script src="/static/js/modal.js" defer></script>

    <!-- Admin JavaScript (only for admin pages) -->
    {{if .IsAdmin}}
    <script src="/static/js/admin.js" defer></script>
    {{end}}

    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
</head>
<body {{if .IsAdmin}}data-is-admin="true"{{end}}>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">
                    <span class="logo-icon">üíï</span>
                    <span class="logo-text">Couple Card Game</span>
                </a>
                
                <button class="hamburger-btn" onclick="MobileMenu.open()" aria-label="Open menu">
                    <span class="hamburger-icon">‚ò∞</span>
                </button>
                
                <nav class="main-nav">
                    {{if .User}}
                    <!-- Notification Bell -->
                        <a href="#" class="notification-bell" onclick="toggleNotifications()" id="notification-btn">
                            üìß
                            <span class="notification-badge" id="notification-badge" hidden>0</span>
                        </a>
                        <div class="notification-dropdown" id="notification-dropdown" hidden>
                            <div class="notification-header">
                                <h3>Notifications</h3>
                                <button onclick="markAllRead()" class="mark-read-btn">Mark all read</button>
                            </div>
                            <div class="notification-list" id="notification-list">
                                <p class="loading">Loading...</p>
                            </div>
                        </div>

                        <a href="/friends" role="button" class="nav-link">Friends</a>
                        <a href="/game/rooms" role="button" class="nav-link">Rooms</a>
                        <a href="/profile" role="button" class="nav-link">Profile</a>
                        
                        <a href="#" role="button" hx-post="/auth/logout" hx-confirm="Are you sure you want to logout?" class="nav-link">Logout</a>
                    {{else}}
                        <a href="/auth/login" role="button">Login</a>
                        <a href="/auth/signup" role="button">Signup</a>
                    {{end}}
                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        {{if .Error}}
        <div class="alert alert-error">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span class="alert-message">{{.Error}}</span>
        </div>
        {{end}}

        {{if .Success}}
        <div class="alert alert-success">
            <span class="alert-icon">‚úÖ</span>
            <span class="alert-message">{{.Success}}</span>
        </div>
        {{end}}

        {{template "content" .}}
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 Couple Card Game. Made with ‚ù§Ô∏è for couples everywhere.</p>
        </div>
    </footer>

    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay" id="mobile-menu-overlay" data-menu="close"></div>
    <div class="mobile-menu-panel" id="mobile-menu-panel" data-menu="close">
        <div class="mobile-menu-header">
            <h2 class="menu-title">Menu</h2>
            <button class="close-btn" id="mobile-menu-close" aria-label="Close menu">√ó</button>
        </div>
        <nav class="mobile-menu-nav">
            {{if .User}}
                <a href="#" class="notification-bell" onclick="toggleNotifications()" id="notification-btn-mobile">
                    üìß
                    <span class="notification-badge" id="notification-badge-mobile" hidden>0</span>
                </a>
                <a href="/friends" class="nav-link">Friends</a>
                <a href="/game/rooms" class="nav-link">Rooms</a>
                <a href="/profile" class="nav-link">Profile</a>
                <a href="#" hx-post="/auth/logout" hx-confirm="Are you sure you want to logout?" class="nav-link">Logout</a>
            {{else}}
                <a href="/auth/login" role="button" class="success">Login</a>
                <a href="/auth/signup" role="button" class="success">Signup</a>
            {{end}}
        </nav>
    </div>
</body>
</html>
{{end}}

